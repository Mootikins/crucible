<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dockview Docked Panels Reference</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, sans-serif; height: 100vh; display: flex; flex-direction: column; background: #1e1e2e; color: #cdd6f4; }
        #controls { padding: 8px 12px; background: #313244; display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
        #controls button { padding: 4px 12px; border: 1px solid #585b70; border-radius: 4px; background: #45475a; color: #cdd6f4; cursor: pointer; font-size: 13px; }
        #controls button:hover { background: #585b70; }
        #controls span { font-size: 12px; color: #a6adc8; }
        #app { flex: 1; overflow: hidden; }

        .dv-docked-panel { border: 1px solid #585b70; }
        .dv-groupview { background: #1e1e2e; }

        .panel-content { padding: 12px; height: 100%; overflow: auto; }
        .panel-content h3 { margin-bottom: 8px; color: #89b4fa; }
        .panel-content p { color: #a6adc8; font-size: 13px; line-height: 1.5; }
        .panel-content code { background: #313244; padding: 2px 6px; border-radius: 3px; font-size: 12px; }

        .dv-tabs-container { background: #313244 !important; }
        .dv-default-tab { color: #cdd6f4 !important; }
        .dv-default-tab.dv-active-tab { background: #45475a !important; }
    </style>
</head>
<body>
    <div id="controls">
        <button onclick="addDockedLeft()">+ Left Panel</button>
        <button onclick="addDockedRight()">+ Right Panel</button>
        <button onclick="addDockedBottom()">+ Bottom Panel</button>
        <button onclick="toggleLeft()">Toggle Left</button>
        <button onclick="toggleRight()">Toggle Right</button>
        <button onclick="toggleBottom()">Toggle Bottom</button>
        <button onclick="addGridPanel()">+ Grid Panel</button>
        <button onclick="roundTrip()">Serialize/Deserialize</button>
        <span id="status"></span>
    </div>
    <div id="app"></div>

    <script type="module">
        import { DockviewComponent } from '../src/index.ts';

        let panelCount = 0;
        const status = document.getElementById('status');

        class SimplePanel {
            constructor() {
                this.element = document.createElement('div');
                this.element.className = 'panel-content';
            }
            init(params) {
                const title = params.params?.title || params.api.title || 'Panel';
                const desc = params.params?.description || '';
                this.element.innerHTML = `<h3>${title}</h3><p>${desc}</p>`;
            }
            layout(w, h) {}
            update(event) {}
            focus() {}
            dispose() {}
            toJSON() { return {}; }
        }

        const container = document.getElementById('app');
        const dockview = new DockviewComponent(container, {
            createComponent(options) {
                return new SimplePanel();
            },
        });

        dockview.layout(container.clientWidth, container.clientHeight);
        window.addEventListener('resize', () => {
            dockview.layout(container.clientWidth, container.clientHeight);
        });

        const mainPanel = dockview.addPanel({
            id: 'main',
            component: 'default',
            title: 'Main Editor',
            params: { title: 'Main Editor', description: 'This is the main grid panel. Docked panels surround it.' },
        });

        function addDockedLeft() {
            panelCount++;
            const panel = dockview.addPanel({
                id: `left-${panelCount}`,
                component: 'default',
                title: `Left ${panelCount}`,
                params: { title: `Left Panel ${panelCount}`, description: 'Docked to the left side.' },
                inactive: true,
            });
            dockview.addDockedGroup(panel, { side: 'left', size: 250 });
            status.textContent = `Added left docked panel #${panelCount}`;
        }

        function addDockedRight() {
            panelCount++;
            const panel = dockview.addPanel({
                id: `right-${panelCount}`,
                component: 'default',
                title: `Right ${panelCount}`,
                params: { title: `Right Panel ${panelCount}`, description: 'Docked to the right side.' },
                inactive: true,
            });
            dockview.addDockedGroup(panel, { side: 'right', size: 250 });
            status.textContent = `Added right docked panel #${panelCount}`;
        }

        function addDockedBottom() {
            panelCount++;
            const panel = dockview.addPanel({
                id: `bottom-${panelCount}`,
                component: 'default',
                title: `Bottom ${panelCount}`,
                params: { title: `Bottom Panel ${panelCount}`, description: 'Docked to the bottom.' },
                inactive: true,
            });
            dockview.addDockedGroup(panel, { side: 'bottom', size: 200 });
            status.textContent = `Added bottom docked panel #${panelCount}`;
        }

        function toggleLeft() {
            dockview.toggleDockedSide('left');
            const groups = dockview.getDockedGroups('left');
            status.textContent = `Left panels: ${groups.length > 0 ? (groups[0].collapsed ? 'collapsed' : 'expanded') : 'none'}`;
        }

        function toggleRight() {
            dockview.toggleDockedSide('right');
            const groups = dockview.getDockedGroups('right');
            status.textContent = `Right panels: ${groups.length > 0 ? (groups[0].collapsed ? 'collapsed' : 'expanded') : 'none'}`;
        }

        function toggleBottom() {
            dockview.toggleDockedSide('bottom');
            const groups = dockview.getDockedGroups('bottom');
            status.textContent = `Bottom panels: ${groups.length > 0 ? (groups[0].collapsed ? 'collapsed' : 'expanded') : 'none'}`;
        }

        function addGridPanel() {
            panelCount++;
            dockview.addPanel({
                id: `grid-${panelCount}`,
                component: 'default',
                title: `Grid ${panelCount}`,
                params: { title: `Grid Panel ${panelCount}`, description: 'A standard grid panel.' },
                position: { direction: 'right' },
            });
            status.textContent = `Added grid panel #${panelCount}`;
        }

        function roundTrip() {
            const serialized = dockview.toJSON();
            const json = JSON.stringify(serialized, null, 2);
            console.log('Serialized layout:', json);

            dockview.fromJSON(serialized);
            status.textContent = `Serialized (${json.length} bytes) and deserialized. Check console for JSON.`;
        }

        window.__dv = dockview;
        window.addDockedLeft = addDockedLeft;
        window.addDockedRight = addDockedRight;
        window.addDockedBottom = addDockedBottom;
        window.toggleLeft = toggleLeft;
        window.toggleRight = toggleRight;
        window.toggleBottom = toggleBottom;
        window.addGridPanel = addGridPanel;
        window.roundTrip = roundTrip;
    </script>
</body>
</html>
