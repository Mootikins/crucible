@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html, body, #root {
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
  }

  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background-color: #171717;
    color: #fafafa;
  }

  ::selection {
    background-color: rgba(59, 130, 246, 0.4);
    color: inherit;
  }

  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: #171717;
  }

  ::-webkit-scrollbar-thumb {
    background: #404040;
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: #525252;
  }
}

@layer components {
  .streaming-cursor {
    @apply inline-block w-0.5 h-4 bg-blue-400 animate-pulse;
  }

  /* User messages: compact bubble, right-aligned */
  .message-bubble {
    @apply rounded-2xl px-4 py-2 max-w-[70%];
  }

  .message-bubble-user {
    @apply bg-blue-600 text-white rounded-br-md;
  }

  /* Assistant messages: full-width, left border accent */
  .message-assistant {
    @apply w-full px-4 py-3 text-neutral-100;
    @apply border-l-[3px] border-blue-500;
    @apply bg-neutral-900/30;
  }
}

/* FlexLayout core styles */
.flexlayout__layout {
  position: relative;
  overflow: hidden;
  width: 100%;
  height: 100%;
  display: flex;
}

.flexlayout__layout_main {
  display: flex;
  flex-basis: 0px;
  min-width: 0;
  min-height: 0;
  flex-grow: 1;
  position: relative;
}

.flexlayout__row {
  display: flex;
  overflow: hidden;
}

.flexlayout__tabset_container {
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.flexlayout__tabset {
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: hidden;
}

.flexlayout__tabset_content {
  flex: 1;
  position: relative;
}

.flexlayout__tabset_tabbar_outer,
.flexlayout__tabset_tabbar_outer_top {
  display: flex;
  align-items: center;
  background: #0a0a0a;
  border-bottom: 1px solid #262626;
  min-height: 32px;
}

.flexlayout__tabset_tabbar_inner,
.flexlayout__tabset_tabbar_inner_top {
  display: flex;
  flex: 1;
  overflow-x: auto;
  overflow-y: hidden;
}

.flexlayout__tabset_tabbar_inner::-webkit-scrollbar,
.flexlayout__tabset_tabbar_inner_top::-webkit-scrollbar {
  height: 0;
}

.flexlayout__tabset_tabbar_inner_tab_container,
.flexlayout__tabset_tabbar_inner_tab_container_top {
  position: relative;
  display: flex;
  padding-left: 4px;
  padding-right: 4px;
  box-sizing: border-box;
}

.flexlayout__tab_button {
  padding: 4px 12px;
  cursor: pointer;
  white-space: nowrap;
  color: #a3a3a3;
  border-bottom: 2px solid transparent;
  user-select: none;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 4px;
  transition: color 0.15s, border-color 0.15s;
}

.flexlayout__tab_button:hover {
  color: #fafafa;
}

.flexlayout__tab_button--selected {
  color: #fafafa;
  border-bottom-color: #3b82f6;
  background: rgba(59, 130, 246, 0.08);
}

.flexlayout__tab_button--unselected {
  opacity: 0.7;
}

.flexlayout__tab_button_content {
  display: flex;
  align-items: center;
}

.flexlayout__tab_button_leading {
  margin-right: 4px;
  display: flex;
  align-items: center;
}

.flexlayout__tab_button_trailing {
  cursor: pointer;
  margin-left: 6px;
  opacity: 0.4;
  display: flex;
  align-items: center;
  transition: opacity 0.15s;
}

.flexlayout__tab_button_trailing:hover {
  opacity: 1;
}

.flexlayout__tab {
  position: absolute;
  overflow: auto;
  background: #0a0a0a;
}

.flexlayout__tab_toolbar {
  display: flex;
  align-items: center;
  padding: 0 4px;
  gap: 2px;
}

.flexlayout__tab_toolbar_button,
.flexlayout__tab_toolbar_button-close,
.flexlayout__tab_toolbar_button-float {
  cursor: pointer;
  padding: 2px 4px;
  color: #737373;
  background: none;
  border: none;
  display: flex;
  align-items: center;
  border-radius: 3px;
  transition: color 0.15s, background 0.15s;
}

.flexlayout__tab_toolbar_button:hover,
.flexlayout__tab_toolbar_button-close:hover,
.flexlayout__tab_toolbar_button-float:hover {
  color: #fafafa;
  background: rgba(255, 255, 255, 0.08);
}

.flexlayout__tabset-selected .flexlayout__tabset_tabbar_outer,
.flexlayout__tabset-selected .flexlayout__tabset_tabbar_outer_top {
  border-bottom-color: #3b82f6;
}

.flexlayout__tabset_tab_divider {
  width: 1px;
  background: #262626;
  margin: 6px 0;
}

.flexlayout__tabset_leading {
  display: flex;
  align-items: center;
  padding: 0 4px;
}

/* Splitter */
.flexlayout__splitter {
  background: #171717;
  z-index: 1;
  transition: background 0.15s;
}

.flexlayout__splitter:hover {
  background: #3b82f6;
}

.flexlayout__splitter_drag {
  position: absolute;
  z-index: 1000;
  background: #3b82f6;
  opacity: 0.7;
}

.flexlayout__splitter_border {
  background: #171717;
  z-index: 1;
}

.flexlayout__splitter_border:hover {
  background: #3b82f6;
}

.flexlayout__splitter_handle {
  display: none;
}

/* Border panels */
.flexlayout__border {
  background: #0a0a0a;
}

.flexlayout__border_top {
  border-bottom: 1px solid #262626;
}

.flexlayout__border_bottom {
  border-top: 1px solid #262626;
}

.flexlayout__border_left {
  border-right: 1px solid #262626;
}

.flexlayout__border_right {
  border-left: 1px solid #262626;
}

.flexlayout__border_inner {
  overflow: hidden;
}

.flexlayout__border_inner_tab_container,
.flexlayout__border_inner_tab_container_top,
.flexlayout__border_inner_tab_container_bottom,
.flexlayout__border_inner_tab_container_left,
.flexlayout__border_inner_tab_container_right {
  display: flex;
}

.flexlayout__border_inner_tab_container_left,
.flexlayout__border_inner_tab_container_right {
  flex-direction: column;
}

.flexlayout__border_button {
  padding: 4px 12px;
  cursor: pointer;
  white-space: nowrap;
  color: #a3a3a3;
  border-bottom: 2px solid transparent;
  user-select: none;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 4px;
  box-sizing: border-box;
  transition: color 0.15s, border-color 0.15s, background 0.15s;
}

.flexlayout__border_button:hover {
  color: #fafafa;
}

.flexlayout__border_button--selected {
  color: #fafafa;
  background: rgba(59, 130, 246, 0.08);
  border-bottom-color: #3b82f6;
}

.flexlayout__border_button--unselected {
  opacity: 0.7;
}

.flexlayout__border_button_content {
  display: flex;
  align-items: center;
}

.flexlayout__border_button_leading {
  margin-right: 4px;
  display: flex;
  align-items: center;
}

.flexlayout__border_button_trailing {
  cursor: pointer;
  margin-left: 6px;
  opacity: 0.4;
}

.flexlayout__border_button_trailing:hover {
  opacity: 1;
}

.flexlayout__border_tab_divider {
  width: 1px;
  background: #262626;
  margin: 4px 0;
}

.flexlayout__border_empty_placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px 12px;
  color: #525252;
  font-size: 12px;
  font-style: italic;
  white-space: nowrap;
  border: 1px dashed #333;
  border-radius: 4px;
  margin: 3px 6px;
  min-width: 80px;
  user-select: none;
}

.flexlayout__border_tab_contents {
  overflow: auto;
  background: #0a0a0a;
}

.flexlayout__border_toolbar,
.flexlayout__border_toolbar_top,
.flexlayout__border_toolbar_bottom,
.flexlayout__border_toolbar_left,
.flexlayout__border_toolbar_right {
  display: flex;
  align-items: center;
  padding: 0 4px;
}

.flexlayout__border_toolbar_button,
.flexlayout__border_toolbar_button_overflow,
.flexlayout__border_toolbar_button-float {
  cursor: pointer;
  padding: 2px 4px;
  color: #737373;
  background: none;
  border: none;
}

.flexlayout__border_toolbar_button:hover,
.flexlayout__border_toolbar_button_overflow:hover {
  color: #fafafa;
}

.flexlayout__border_sizer {
  background: #171717;
}

.flexlayout__border_leading {
  display: flex;
  align-items: center;
}

.flexlayout__border_fab {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  padding: 0;
  margin: 0;
  border: 1px solid #262626;
  border-radius: 3px;
  background: #0a0a0a;
  color: #737373;
  font-size: 10px;
  line-height: 1;
  cursor: pointer;
  box-sizing: border-box;
}

.flexlayout__border_fab:hover {
  color: #d4d4d4;
  background: #171717;
}

.flexlayout__border_fab:focus-visible {
  outline: 2px solid #3b82f6;
  outline-offset: 1px;
}

/* Border dock button (state cycle: expanded → collapsed → hidden) */
.flexlayout__border_dock_button {
  cursor: pointer;
  padding: 2px 6px;
  color: #737373;
  background: none;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  line-height: 1;
  opacity: 0.7;
  transition: opacity 0.15s ease, color 0.15s ease;
}

.flexlayout__border_dock_button:hover {
  opacity: 1;
  color: #d4d4d4;
}

/* Border collapsed state — hide content + splitter, show vertical labels */
.flexlayout__border--collapsed .flexlayout__border_tab_contents {
  display: none !important;
}

.flexlayout__border--collapsed .flexlayout__splitter_border {
  display: none !important;
}

/* Border hidden state — hide everything (FAB overlay shown separately) */
.flexlayout__border--hidden .flexlayout__border_tab_contents {
  display: none !important;
}

.flexlayout__border--hidden .flexlayout__splitter_border {
  display: none !important;
}

.flexlayout__border--hidden .flexlayout__border_inner {
  display: none !important;
}

.flexlayout__border--hidden .flexlayout__mini_scrollbar_container {
  display: none !important;
}

/* Collapsed label (tab names in collapsed left/right borders, rotated) */
.flexlayout__border_collapsed_label {
  padding: 3px 0.5em;
  color: #737373;
  white-space: nowrap;
  font-size: 12px;
  user-select: none;
  display: flex;
  align-items: center;
}

/* Border content transition */
.flexlayout__border_tab_contents {
  transition: flex-basis 0.2s ease, width 0.2s ease, height 0.2s ease;
}

/* Border tab bar (tabs-on-top for expanded borders) */
.flexlayout__border_tabbar {
  display: flex;
  flex-direction: row;
  align-items: center;
  background: #0a0a0a;
  border-bottom: 1px solid #262626;
  min-height: 32px;
  flex-shrink: 0;
  position: relative;
  z-index: 1;
}

/* DnD overlay + outline */
.flexlayout__layout_overlay {
  pointer-events: none;
}

.flexlayout__outline_rect {
  position: absolute;
  border: 2px dashed #3b82f6;
  background: rgba(59, 130, 246, 0.1);
  pointer-events: none;
  z-index: 1000;
  transition: top 0.15s, left 0.15s, width 0.15s, height 0.15s;
}

.flexlayout__outline_rect_tab_reorder {
  border: none;
  background: #3b82f6;
  border-radius: 1px;
  transition: top 0.1s, left 0.1s, height 0.1s;
}

.flexlayout__outline_rect_edge {
  position: absolute;
  border: 2px dashed #3b82f6;
  background: rgba(59, 130, 246, 0.15);
  pointer-events: none;
  z-index: 1000;
}

/* Edge dock indicators */
.flexlayout__edge_rect {
  position: absolute;
  background: rgba(59, 130, 246, 0.15);
  z-index: 999;
}

/* Popup menu (overflow) */
.flexlayout__popup_menu_container {
  position: fixed;
  z-index: 10000;
}

.flexlayout__popup_menu {
  background: #262626;
  border: 1px solid #404040;
  border-radius: 6px;
  padding: 4px 0;
  min-width: 120px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
}

.flexlayout__popup_menu_item {
  padding: 6px 12px;
  cursor: pointer;
  color: #d4d4d4;
  font-size: 13px;
  white-space: nowrap;
}

.flexlayout__popup_menu_item:hover,
.flexlayout__popup_menu_item--selected {
  background: rgba(59, 130, 246, 0.15);
  color: #fafafa;
}

/* Error boundary */
.flexlayout__error_boundary_container {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  color: #ef4444;
  padding: 16px;
}

.flexlayout__error_boundary_content {
  text-align: center;
  font-size: 13px;
}

/* Drag rect (ghost) */
.flexlayout__drag_rect {
  position: absolute;
  background: rgba(59, 130, 246, 0.2);
  border: 1px solid #3b82f6;
  border-radius: 4px;
  pointer-events: none;
  z-index: 10000;
}

/* Tab button stamp (drag ghost) */
.flexlayout__tab_button_stamp {
  position: absolute;
  visibility: hidden;
  pointer-events: none;
}

/* Maximize state */
.flexlayout__tabset-maximized {
  z-index: 100;
}

/* Floating window content */
.flexlayout__floating_window_content {
  width: 100%;
  height: 100%;
  overflow: hidden;
}

/* Floating panel (in-DOM overlay for float windows) */
.flexlayout__floating_panel {
  position: absolute;
  z-index: 1000;
  display: flex;
  flex-direction: column;
  border: 1px solid #555;
  border-radius: 4px;
  background: var(--flexlayout-bg, #1e1e1e);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
  overflow: hidden;
}

.flexlayout__floating_panel_titlebar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 2px 6px;
  background: var(--flexlayout-tabset-header-bg, #2d2d2d);
  cursor: move;
  user-select: none;
  min-height: 24px;
  font-size: 12px;
  color: var(--flexlayout-tab-color, #ccc);
}

.flexlayout__floating_panel_titlebar_title {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.flexlayout__floating_panel_titlebar_buttons {
  display: flex;
  gap: 4px;
  align-items: center;
}

.flexlayout__floating_panel_titlebar_buttons button {
  background: none;
  border: none;
  color: inherit;
  cursor: pointer;
  padding: 0 4px;
  font-size: 12px;
  opacity: 0.7;
}

.flexlayout__floating_panel_titlebar_buttons button:hover {
  opacity: 1;
}

.flexlayout__floating_panel_content {
  flex: 1;
  position: relative;
  overflow: hidden;
  display: flex;
}

.flexlayout__floating_panel_resize_handle {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 12px;
  height: 12px;
  cursor: nwse-resize;
  opacity: 0.5;
  background: linear-gradient(135deg, transparent 50%, #888 50%, transparent 55%, #888 60%, transparent 65%, #888 70%);
}

.flexlayout__floating_panel_resize_n {
  position: absolute;
  top: -3px;
  left: 6px;
  right: 6px;
  height: 6px;
  cursor: ns-resize;
}

.flexlayout__floating_panel_resize_s {
  position: absolute;
  bottom: -3px;
  left: 6px;
  right: 6px;
  height: 6px;
  cursor: ns-resize;
}

.flexlayout__floating_panel_resize_e {
  position: absolute;
  top: 6px;
  right: -3px;
  bottom: 6px;
  width: 6px;
  cursor: ew-resize;
}

.flexlayout__floating_panel_resize_w {
  position: absolute;
  top: 6px;
  left: -3px;
  bottom: 6px;
  width: 6px;
  cursor: ew-resize;
}

.flexlayout__floating_panel_resize_nw {
  position: absolute;
  top: -3px;
  left: -3px;
  width: 10px;
  height: 10px;
  cursor: nwse-resize;
}

.flexlayout__floating_panel_resize_ne {
  position: absolute;
  top: -3px;
  right: -3px;
  width: 10px;
  height: 10px;
  cursor: nesw-resize;
}

.flexlayout__floating_panel_resize_sw {
  position: absolute;
  bottom: -3px;
  left: -3px;
  width: 10px;
  height: 10px;
  cursor: nesw-resize;
}

.flexlayout__floating_panel_resize_se {
  position: absolute;
  bottom: -3px;
  right: -3px;
  width: 10px;
  height: 10px;
  cursor: nwse-resize;
}

.flexlayout__floating_panel_outline {
  position: absolute;
  z-index: 10000;
  border: 2px dashed #3b82f6;
  background: rgba(59, 130, 246, 0.08);
  pointer-events: none;
  border-radius: 4px;
}

/* Mini scrollbar for borders */
.flexlayout__mini_scrollbar_container {
  overflow: hidden;
  flex: 1;
}

/* Tab overflow button */
.flexlayout__tab_button_overflow {
  padding: 4px 8px;
  cursor: pointer;
  color: #737373;
  display: flex;
  align-items: center;
}

.flexlayout__tab_button_overflow:hover {
  color: #fafafa;
}

.flexlayout__tab_button_overflow_count {
  font-size: 10px;
  margin-left: 2px;
}

/* Tab button stretch (single tab fills tabset) */
.flexlayout__tab_button_stretch {
  flex: 1;
}

/* Tab button textbox (rename) */
.flexlayout__tab_button_textbox {
  background: #171717;
  color: #fafafa;
  border: 1px solid #3b82f6;
  padding: 1px 4px;
  font-size: 13px;
  outline: none;
}

/* Splitter extra hit area */
.flexlayout__splitter_extra {
  position: absolute;
  z-index: 0;
}

/* Tab position (moveable container) */
.flexlayout__tab_position {
  position: absolute;
}

.flexlayout__tab_moveable {
  position: absolute;
  overflow: auto;
}

/* Tab overlay (for popout graying) */
.flexlayout__tab_overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 10;
}

/* Layout tab stamps container */
.flexlayout__layout_tab_stamps {
  position: absolute;
  visibility: hidden;
  pointer-events: none;
}

/* Layout moveables container */
.flexlayout__layout_moveables {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.flexlayout__layout_border_container {
  display: flex;
  flex-basis: 0px;
  min-width: 0;
  min-height: 0;
  flex-grow: 1;
}

.flexlayout__layout_border_container_inner {
  display: flex;
  flex-basis: 0px;
  min-width: 0;
  min-height: 0;
  flex-grow: 1;
}

/* Tabset header (optional header above tab strip) */
.flexlayout__tabset_header {
  display: flex;
  align-items: center;
  padding: 0 8px;
  background: #0a0a0a;
  border-bottom: 1px solid #262626;
  min-height: 24px;
}

.flexlayout__tabset_header_content {
  flex: 1;
  font-size: 11px;
  color: #737373;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* Toolbar sticky buttons */
.flexlayout__tab_toolbar_sticky_buttons_container {
  display: flex;
  align-items: center;
}

/* Tab toolbar icon */
.flexlayout__tab_toolbar_icon {
  display: flex;
  align-items: center;
}

/* Reduced motion support for accessibility */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
